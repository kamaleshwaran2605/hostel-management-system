<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin Dashboard</title>

  <!-- Bootstrap (optional) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  
  <!-- Custom CSS -->
  <link rel="stylesheet" href="admin.css">
</head>
<body>

<header class="site-header">
  <div class="container">
    <h1>📊 Admin Dashboard</h1>
  </div>
</header>

<main class="container">
  <div class="dashboard">
    
    <div class="card stat-card" onclick="window.location.href='management.html'">
      <h3 class="card-title">🏠 Vacating Requests</h3>
      <div class="count" id="vacatingCount"></div>
    </div>

    <div class="card stat-card" onclick="openGatePass()">
      <h3 class="card-title">📜 Gate Pass Requests</h3>
      <div class="count" id="gatePassCount"></div>
      <div class="card-note">Click to open form</div>
    </div>

    <div class="card stat-card" onclick="window.location.href='managedup.html'">
      <h3 class="card-title">🛠 Complaints</h3>
      <div class="count" id="complaintsCount"></div>
    </div>

    <div class="card stat-card" onclick="window.location.href='foodmenu.html'">
      <h3 class="card-title">🍾🍵 food menu timetable</h3>
      <div class="count" id="food menu"></div>
    </div>
    <div class="card stat-card" onclick="window.location.href='announce.html'">
      <h3 class="card-title">💻 announcement</h3>
      <div class="count" id="food menu"></div>
    </div>
    <div class="card stat-card" onclick="window.location.href='index.html'">
      <h3 class="card-title"> <i style="font-size:24px" class="fa">&#xf0a9;</i> LOGOUT</h3>
      <div class="count" id="LOG OUT"></div>
    </div>

  </div>
</main>

<script>
  function openGatePass(){
    window.open(
      'https://docs.google.com/forms/d/1J_JkwGRsNqyGtAM6tQtyO6dkBoPp5ftZ_47b18mTvEI/edit ',
      'GatePassForm',
      'width=900,height=700,scrollbars=yes'
    );
  }

 
async function updateGatePassCount(){
  const sheetCSV = "https://docs.google.com/spreadsheets/d/e/2PACX-1vRXTAvz3DrbGU2gX3J9lvUIx9vZaTwsnJruJQjAyupWUn2xx2FGFQtk5yUxZMUsLSOPF62TOb7avasn/pub?output=csv";

  try {
    const response = await fetch(sheetCSV);
    const data = await response.text();
    const rows = data.trim().split("\n");
    document.getElementById("gatePassCount").innerText = rows.length - 1; // subtract header row
  } catch (err) {
    console.error("Error fetching responses:", err);
  }
}

updateGatePassCount();

</script>


</body>
</html>