<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Student Announcement</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet" />

  <!-- SweetAlert2 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css" rel="stylesheet" />

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #eef2f7;
      margin: 0; padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      color: #222;
    }
    .container {
      background: white;
      width: 480px;
      padding: 30px 40px;
      border-radius: 10px;
      box-shadow: 0 12px 20px rgb(0 0 0 / 0.1);
      text-align: center;
    }
    h2 {
      margin-bottom: 25px;
      font-weight: 600;
    }
    #announcementBox {
      border: 2px solid #4a90e2;
      padding: 20px;
      border-radius: 10px;
      min-height: 140px;
      font-size: 16px;
      color: #333;
      white-space: pre-wrap;
      background: #f0f5ff;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Latest Announcement</h2>
    <div id="announcementBox">Loading announcement...</div>
  </div>

  <script>
    // Replace with your Firebase config
     const firebaseConfig = {
  apiKey: "AIzaSyBqe9bYKH6ogOZwri-O9eHfHzG4hs6pBe8",
  authDomain: "hackathaon-97878.firebaseapp.com",
  projectId: "hackathaon-97878",
  storageBucket: "hackathaon-97878.firebasestorage.app",
  messagingSenderId: "406563265418",
  appId: "1:406563265418:web:00a80a3f3a23e76dca4673",
  measurementId: "G-717FQ25KJK"
};



    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const announcementBox = document.getElementById('announcementBox');

    function showAnnouncementPopup(message, timestamp) {
      const date = new Date(timestamp);
      Swal.fire({
        title: 'Announcement',
        html: `<p style="white-space: pre-line;">${message}</p><small>Posted on: ${date.toLocaleString()}</small>`,
        icon: 'info',
        confirmButtonText: 'Close',
        width: '600px',
        didOpen: () => {
          Swal.getHtmlContainer().style.fontFamily = "'Inter', sans-serif";
          Swal.getHtmlContainer().style.fontSize = '16px';
          Swal.getHtmlContainer().style.color = '#333';
        }
      });
    }

    function checkAndShowAnnouncement(data) {
      if (data && data.message && data.timestamp) {
        const now = Date.now();
        const age = now - data.timestamp;
        const oneDay = 24 * 60 * 60 * 1000; // milliseconds in 24 hours

        if (age > oneDay) {
          // Delete announcement from Firebase if older than 24 hours
          database.ref('announcement').remove()
            .then(() => {
              announcementBox.textContent = "No announcement posted yet.";
            })
            .catch(err => {
              announcementBox.textContent = "Failed to delete old announcement: " + err.message;
            });
        } else {
          // Show announcement and popup
          announcementBox.innerHTML = data.message.replace(/\n/g, "<br>");
          showAnnouncementPopup(data.message, data.timestamp);
        }
      } else {
        announcementBox.textContent = "No announcement posted yet.";
      }
    }

    // Fetch announcement once on page load
    database.ref('announcement').once('value').then(snapshot => {
      checkAndShowAnnouncement(snapshot.val());
    }).catch(err => {
      announcementBox.textContent = "Failed to load announcement: " + err.message;
    });
  </script>
</body>
</html>
